{% load static %}
<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - MediPulse</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¥ MediPulse - Painel Administrativo</h1>
            <div class="user-info">
                <span>ğŸ‘¤ {{ request.user.nome }}</span>
                <a href="{% url 'logout' %}" class="logout-btn">Sair</a>
            </div>
        </div>

        {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <div class="alert {% if message.tags %}{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="nav-menu">
            <a href="{% url 'admin_dashboard' %}" class="active">ğŸ“Š Dashboard</a>
            <a href="{% url 'admin_utilizadores' %}">ğŸ‘¥ Utilizadores</a>
            <a href="{% url 'admin_regioes' %}">ğŸ—ºï¸ RegiÃµes</a>
            <a href="{% url 'admin_especialidades' %}">ğŸ¥ Especialidades</a>
            <a href="{% url 'admin_unidades' %}">ğŸ¢ Unidades</a>
            <a href="{% url 'admin_consultas' %}">ğŸ“… Consultas</a>
            <a href="{% url 'admin_faturas' %}">ğŸ’° Faturas</a>
            <a href="{% url 'admin_relatorios' %}">ğŸ“ˆ RelatÃ³rios</a>
            <a href="{% url 'home' %}">ğŸ  Home</a>
        </div>

        <div class="stats-grid">
            <div class="stat-card variant-indigo">
                <h3>ğŸ‘¥ Pacientes</h3>
                <div class="number">{{ total_pacientes }}</div>
            </div>
            <div class="stat-card variant-orange">
                <h3>ğŸ‘¨â€âš•ï¸ MÃ©dicos</h3>
                <div class="number">{{ total_medicos }}</div>
            </div>
            <div class="stat-card variant-teal">
                <h3>ğŸ‘©â€âš•ï¸ Enfermeiros</h3>
                <div class="number">{{ total_enfermeiros }}</div>
            </div>
            <div class="stat-card variant-blue">
                <h3>ğŸ¢ Unidades</h3>
                <div class="number">{{ total_unidades }}</div>
            </div>
            <div class="stat-card variant-green">
                <h3>ğŸ“… Consultas Hoje</h3>
                <div class="number">{{ consultas_hoje }}</div>
            </div>
            <div class="stat-card variant-yellow">
                <h3>â³ Pendentes</h3>
                <div class="number">{{ consultas_pendentes }}</div>
            </div>
            <div class="stat-card variant-blue">
                <h3>ğŸ“Š Consultas MÃªs</h3>
                <div class="number">{{ consultas_mes }}</div>
            </div>
            <div class="stat-card variant-green">
                <h3>ğŸ’° Receita MÃªs</h3>
                <div class="number">â‚¬{{ receita_mes|floatformat:2 }}</div>
            </div>
        </div>

        <div class="content-section">
            <h2>ğŸ“‹ Ãšltimas Consultas</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Paciente</th>
                        <th>MÃ©dico</th>
                        <th>Data</th>
                        <th>Hora</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    {% for consulta in ultimas_consultas %}
                    <tr>
                        <td>{{ consulta.id_consulta }}</td>
                        <td>{{ consulta.paciente_nome }}</td>
                        <td>{{ consulta.medico_nome }}</td>
                        <td>{{ consulta.data_consulta|date:"d/m/Y" }}</td>
                        <td>{{ consulta.hora_consulta }}</td>
                        <td>
                            {% if consulta.estado == 'realizada' %}
                                <span class="badge success">{{ consulta.estado|upper }}</span>
                            {% elif consulta.estado == 'agendada' %}
                                <span class="badge warning">{{ consulta.estado|upper }}</span>
                            {% elif consulta.estado == 'cancelada' %}
                                <span class="badge danger">{{ consulta.estado|upper }}</span>
                            {% else %}
                                <span class="badge info">{{ consulta.estado|upper }}</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" style="text-align: center;">Nenhuma consulta registada</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% if faturas_pendentes > 0 %}
        <div class="content-section">
            <h2>âš ï¸ Alertas</h2>
            <p style="color: #e74c3c; font-weight: bold;">
                Existem {{ faturas_pendentes }} fatura(s) pendente(s) de pagamento.
                <a href="{% url 'admin_faturas' %}?estado=pendente" style="color: #667eea;">Ver faturas</a>
            </p>
        </div>
        {% endif %}
    </div>
</body>
</html>
