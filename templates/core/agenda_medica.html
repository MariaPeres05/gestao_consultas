<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Agenda - Disponibilidades</title>
  <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css' rel='stylesheet' />
  <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js'></script>
  <style>body{font-family:Arial,Helvetica,sans-serif;padding:20px} #calendar{max-width:1000px;margin:0 auto}</style>
</head>
<body>
  <h2>Agenda — Disponibilidades</h2>
  <div id="calendar"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');
      var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        headerToolbar: { left: 'prev,next today', center: 'title', right: 'dayGridMonth,timeGridWeek,timeGridDay' },
        events: {
          url: '{% url "api_disponibilidades" %}',
          method: 'GET',
        },
        eventTimeFormat: { hour: '2-digit', minute: '2-digit', hour12: false },
        eventClick: function(info) {
          // Ao clicar num evento podemos redirecionar para a página de agendamento com filtro
          var dispId = info.event.id;
          // redirecionar para a página de marcação e filtrar pela disponibilidade
          window.location.href = '{% url "marcar_consulta" %}?disponibilidade=' + dispId;
        }
      });
      calendar.render();
    });
  </script>
</body>
</html>